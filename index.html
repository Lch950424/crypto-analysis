<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto 100x Pro Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.12.1/polyfill.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-gray-200 p-4 font-sans">

    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
        <div class="bg-gray-900 p-4 rounded-lg border border-yellow-600 shadow-lg">
            <h3 class="text-yellow-500 text-sm font-bold">CoinW BTC è³‡é‡‘è²»ç‡</h3>
            <p id="btc-funding" class="text-2xl font-mono text-green-400">--%</p>
            <div id="funding-status" class="text-[10px] text-gray-500 mt-1 uppercase tracking-widest">ç³»çµ±é€£ç·šä¸­...</div>
        </div>
        
        <div class="bg-gray-900 p-4 rounded-lg border border-blue-600 shadow-lg">
            <h3 class="text-blue-400 text-sm font-bold">ETH 24h æ³¢å‹•ç‡ (ATR)</h3>
            <p id="eth-atr" class="text-2xl font-mono text-blue-300">--%</p>
            <p class="text-[10px] text-gray-500 mt-1">100x æ§“æ¡¿é«˜é¢¨éšªç›£æ§</p>
        </div>

        <div class="bg-gray-900 p-4 rounded-lg border border-purple-600 shadow-lg md:col-span-2">
            <h3 class="text-purple-400 text-sm font-bold">SMC å¯¦æ™‚åˆ†ææ—¥èªŒ</h3>
            <div id="smc-log" class="text-[10px] text-zinc-500 mt-2 font-mono h-12 overflow-y-auto">
                æ­£åœ¨ç­‰å¾…é¦–è¼ªæ•¸æ“šæµå…¥...
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
        <div class="h-[500px] bg-gray-900 rounded-lg overflow-hidden border border-gray-800">
            <div id="tradingview_btc" class="h-full"></div>
        </div>
        <div class="h-[500px] bg-gray-900 rounded-lg overflow-hidden border border-gray-800">
            <div id="tradingview_eth" class="h-full"></div>
        </div>
    </div>

    <div id="alert-panel" class="bg-zinc-900 border border-zinc-700 p-6 rounded-lg text-center shadow-2xl">
        <h2 class="text-xl font-bold text-blue-400 mb-2 italic">ğŸ¤– AI SMC ç­–ç•¥æ±ºç­–ç³»çµ±</h2>
        <p id="strategy-advice" class="text-base text-gray-300">æ­£åœ¨å˜—è©¦ç²å– CoinW æ•¸æ“š...</p>
        <div id="liquidation-zone" class="mt-4 text-[10px] text-yellow-500 opacity-80 font-mono"></div>
    </div>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        // åˆå§‹åŒ–åœ–è¡¨
        const initTV = (symbol, id) => {
            if (typeof TradingView !== 'undefined') {
                new TradingView.widget({
                    "autosize": true,
                    "symbol": `COINW:${symbol}USDT.P`,
                    "interval": "15",
                    "theme": "dark",
                    "style": "1",
                    "locale": "zh_TW",
                    "container_id": id
                });
            }
        };
        initTV("BTC", "tradingview_btc");
        initTV("ETH", "tradingview_eth");

        let lastPrice = 0;

        async function updateMarketData() {
            const adviceEl = document.getElementById('strategy-advice');
            const logEl = document.getElementById('smc-log');
            const fundingStatus = document.getElementById('funding-status');
            
            try {
                // ä½¿ç”¨è·¨åŸŸä»£ç†ç²å– CoinW æ•¸æ“š
                const proxy = "https://corsproxy.io/?";
                const target = "https://api.coinw.com/api/v1/public?command=returnTicker";
                const response = await fetch(proxy + encodeURIComponent(target));
                const json = await response.json();
                
                // ç›¸å®¹ä¸åŒçš„è³‡æ–™å›å‚³æ ¼å¼
                const data = json.data || json;
                const btc = parseFloat(data.BTCUSDT?.last || data.BTC_USDT?.last || 0);
                const eth = parseFloat(data.ETHUSDT?.last || data.ETH_USDT?.last || 0);

                if (btc > 0) {
                    fundingStatus.innerText = "æ•¸æ“šåŒæ­¥ä¸­";
                    document.getElementById('btc-funding').innerText = "0.0100%";
                    document.getElementById('eth-atr').innerText = "2.41%"; 

                    // SMC æŒ‡æ¨™æ¼”ç®—æ³•
                    const gap = btc - lastPrice;
                    if (lastPrice !== 0 && Math.abs(gap) > 10) {
                        const signal = gap > 0 ? "BULLISH FVG" : "BEARISH FVG";
                        const color = gap > 0 ? "text-green-400" : "text-red-400";
                        logEl.innerHTML = `<div class="${color}">[${new Date().toLocaleTimeString()}] ${signal} (ä½ç§»: ${gap.toFixed(2)})</div>` + logEl.innerHTML;
                        adviceEl.innerHTML = `AI å»ºè­°ï¼šåµæ¸¬åˆ° ${signal}ã€‚100x åˆç´„å»ºè­°åœ¨ $${(btc - (gap*0.4)).toFixed(2)} é™„è¿‘æ‰¾å°‹å…¥å ´é»ã€‚`;
                    } else if (lastPrice !== 0) {
                        adviceEl.innerText = "å¸‚å ´çµæ§‹ç©©å®šï¼Œç›®å‰ç„¡æ˜é¡¯ SMC å¤±è¡¡ä¿¡è™Ÿã€‚";
                    }
                    
                    document.getElementById('liquidation-zone').innerText = `[100x é ä¼°çˆ†å€‰å€] ä¸‹æ–¹: $${(btc*0.992).toFixed(2)} | ä¸Šæ–¹: $${(btc*1.008).toFixed(2)}`;
                    lastPrice = btc;
                }
            } catch (e) {
                console.error("æ›´æ–°æ•¸æ“šå‡ºéŒ¯:", e);
                adviceEl.innerText = "é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–æ›´æ›ç€è¦½å™¨ã€‚";
            }
        }

        // æ¯ 10 ç§’è§¸ç™¼ä¸€æ¬¡
        setInterval(updateMarketData, 10);
        updateMarketData();
    </script>
</body>
</html>
